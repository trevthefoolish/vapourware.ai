<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Ecclesiastes 1:1-4</title>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;1,300;1,400&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
  <style>
    :root {
      --gold: #daa520;
      --gold-lit: #f0d060;
      --cream: #f5f2eb;
      --cream-dim: rgba(245, 242, 235, 0.68);
      --bg: #0a0a0a;
      --font-title-en: clamp(24px, 4vw, 48px);
      --font-title-he: clamp(50px, 10vw, 120px);
      --font-word-he: clamp(30px, 5.5vw, 56px);
      --font-word-en: clamp(20px, 3vw, 36px);
      --word-padding: 0.2em 0.35em;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    html, body {
      height: 100%;
      background: var(--bg);
      overflow: hidden;
      font-family: 'Cormorant Garamond', serif;
    }

    /* ===== SWIPER ===== */
    .swiper {
      width: 100%;
      height: 100%;
    }

    .swiper-slide {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .swiper-pagination-progressbar {
      background: transparent !important;
      top: auto !important;
      bottom: env(safe-area-inset-bottom, 0) !important;
      height: clamp(3px, 0.4vw, 5px) !important;
    }

    .swiper-pagination-progressbar-fill {
      background: linear-gradient(90deg, rgba(218, 165, 32, 0.7), rgba(240, 208, 96, 0.85)) !important;
      box-shadow: 0 0 12px rgba(218, 165, 32, 0.4);
    }

    /* ===== TITLES ===== */
    .title-en {
      position: absolute;
      font-size: var(--font-title-en);
      font-weight: 300;
      color: var(--cream);
      letter-spacing: 0.2em;
      text-transform: uppercase;
    }

    .title-he {
      position: fixed;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      font-size: var(--font-title-he);
      font-weight: 400;
      color: var(--gold);
      direction: rtl;
      z-index: 100;
      padding: var(--word-padding);
      cursor: pointer;
      -webkit-user-select: none;
      user-select: none;
      opacity: 0;
      pointer-events: none;
    }

    .title-he.visible {
      pointer-events: auto;
    }

    /* ===== VERSES ===== */
    .verse {
      display: flex;
      flex-direction: column;
      align-items: center;
      max-width: min(90vw, 900px);
    }

    .verse-he {
      direction: rtl;
      text-align: center;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-items: baseline;
      gap: 0.3em 0.45em;
      line-height: 1.6;
    }

    .verse-en {
      font-size: var(--font-word-en);
      font-weight: 400;
      font-style: italic;
      line-height: 2.2;
      margin-top: 1.1em;
      text-align: center;
      color: var(--cream-dim);
      letter-spacing: 0.03em;
      opacity: 0;
    }

    /* ===== WORDS ===== */
    .word-he {
      font-size: var(--font-word-he);
      font-weight: 400;
      color: var(--gold);
      padding: var(--word-padding);
      cursor: pointer;
      transition: color 0.25s, text-shadow 0.25s;
      -webkit-user-select: none;
      user-select: none;
      opacity: 0;
    }

    .word-en {
      color: var(--cream-dim);
      padding: 0.1em 0.15em;
      cursor: pointer;
      transition: color 0.25s, text-shadow 0.25s;
      -webkit-user-select: none;
      user-select: none;
    }

    .placeholder {
      font-size: var(--font-word-he);
      font-weight: 400;
      color: transparent;
      padding: var(--word-padding);
    }

    /* ===== LIT STATES ===== */
    [data-link].lit {
      animation: glowPulse 2.5s ease-in-out infinite;
    }

    .word-he.lit, .title-he.lit {
      color: var(--gold-lit);
      text-shadow: 0 0 20px rgba(218, 165, 32, 0.6);
    }

    .word-en.lit {
      color: #fff;
      text-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
    }

    @keyframes glowPulse {
      0%, 100% { filter: brightness(1); }
      50% { filter: brightness(1.1); }
    }

    /* ===== TIPPY THEME ===== */
    .tippy-box[data-theme~='ecclesiastes'] {
      background: rgba(10, 8, 6, 0.85);
      backdrop-filter: blur(24px);
      -webkit-backdrop-filter: blur(24px);
      border: 1px solid rgba(218, 165, 32, 0.25);
      border-radius: clamp(12px, 1.5vw, 16px);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4), 0 0 80px rgba(218, 165, 32, 0.08);
    }

    .tippy-box[data-theme~='ecclesiastes'] .tippy-content {
      padding: clamp(16px, 2vw, 24px) clamp(20px, 2.5vw, 32px);
    }

    .tippy-box[data-theme~='ecclesiastes'] .tippy-arrow {
      color: rgba(10, 8, 6, 0.85);
    }

    .tooltip-hebrew {
      font-size: clamp(22px, 4vw, 34px);
      color: var(--gold);
      direction: rtl;
      text-align: center;
      margin-bottom: clamp(6px, 1vw, 10px);
      font-weight: 500;
      text-shadow: 0 0 20px rgba(218, 165, 32, 0.3);
    }

    .tooltip-translit {
      font-size: clamp(14px, 2.5vw, 20px);
      color: var(--cream);
      text-align: center;
      font-style: italic;
      letter-spacing: 0.05em;
      margin-bottom: clamp(10px, 1.5vw, 14px);
      padding-bottom: clamp(10px, 1.5vw, 14px);
      border-bottom: 1px solid rgba(218, 165, 32, 0.25);
    }

    .tooltip-tidbit {
      font-size: clamp(13px, 2vw, 18px);
      color: rgba(232, 228, 220, 0.85);
      line-height: 1.6;
      max-width: 340px;
    }

    /* ===== HINTS ===== */
    .hint {
      position: fixed;
      bottom: calc(28px + env(safe-area-inset-bottom, 0px));
      left: 50%;
      transform: translateX(-50%);
      font-size: clamp(12px, 1.5vw, 16px);
      letter-spacing: 0.15em;
      text-transform: uppercase;
      font-weight: 300;
      pointer-events: none;
      z-index: 50;
      opacity: 0;
      transition: opacity 0.5s;
    }

    .scroll-hint { color: rgba(245, 242, 235, 0.5); }
    .tap-hint { color: rgba(218, 165, 32, 0.6); }

    .hint.visible { opacity: 1; }

    .chevron {
      width: clamp(20px, 2.5vw, 28px);
      height: clamp(20px, 2.5vw, 28px);
      margin: 6px auto 0;
      border-right: 2px solid rgba(218, 165, 32, 0.5);
      border-bottom: 2px solid rgba(218, 165, 32, 0.5);
      transform: rotate(45deg);
      animation: bounce 1.5s ease-in-out infinite;
    }

    @keyframes bounce {
      0%, 100% { transform: rotate(45deg) translateY(0); }
      50% { transform: rotate(45deg) translateY(4px); }
    }
  </style>
</head>
<body>

  <!-- Floating Qohelet -->
  <div class="title-he" id="qohelet" data-link="teacher">קֹהֶלֶת</div>

  <!-- Swiper -->
  <div class="swiper">
    <div class="swiper-wrapper">
      <div class="swiper-slide">
        <div class="title-en">Ecclesiastes</div>
      </div>

      <div class="swiper-slide">
        <div class="title-en" style="transform: translateY(-50px)">Ecclesiastes</div>
      </div>

      <div class="swiper-slide"></div>

      <div class="swiper-slide">
        <div class="verse">
          <div class="verse-he">
            <span class="word-he" data-link="words">דִּבְרֵי</span>
            <span class="placeholder" id="ph1">קֹהֶלֶת</span>
            <span class="word-he" data-link="son">בֶּן־דָּוִד</span>
            <span class="word-he" data-link="king">מֶלֶךְ</span>
            <span class="word-he" data-link="jerusalem">בִּירוּשָׁלָֽםִ</span>
          </div>
          <div class="verse-en">The <span class="word-en" data-link="words">words</span> of the <span class="word-en" data-link="teacher">Teacher</span>, <span class="word-en" data-link="son">son of David</span>, <span class="word-en" data-link="king">king</span> in <span class="word-en" data-link="jerusalem">Jerusalem</span></div>
        </div>
      </div>

      <div class="swiper-slide">
        <div class="verse">
          <div class="verse-he">
            <span class="word-he" data-link="vanity">הֲבֵל</span>
            <span class="word-he" data-link="vanity">הֲבָלִים</span>
            <span class="word-he" data-link="says">אָמַר</span>
            <span class="placeholder" id="ph2">קֹהֶלֶת</span>
            <span class="word-he" data-link="vanity">הֲבֵל</span>
            <span class="word-he" data-link="vanity">הֲבָלִים</span>
            <span class="word-he" data-link="all">הַכֹּל</span>
            <span class="word-he" data-link="vanity">הָבֶל</span>
          </div>
          <div class="verse-en"><span class="word-en" data-link="vanity">Vanity</span> of <span class="word-en" data-link="vanity">vanities</span>, <span class="word-en" data-link="says">says</span> the <span class="word-en" data-link="teacher">Teacher</span>, <span class="word-en" data-link="vanity">vanity</span> of <span class="word-en" data-link="vanity">vanities</span>! <span class="word-en" data-link="all">All</span> is <span class="word-en" data-link="vanity">vanity</span>.</div>
        </div>
      </div>

      <div class="swiper-slide">
        <div class="verse">
          <div class="verse-he">
            <span class="word-he" data-link="gain">מַה־יִּתְרוֹן</span>
            <span class="word-he" data-link="man">לָאָדָם</span>
            <span class="word-he" data-link="labor">בְּכָל־עֲמָלוֹ</span>
            <span class="word-he" data-link="toils">שֶׁיַּעֲמֹל</span>
            <span class="word-he" data-link="under">תַּחַת</span>
            <span class="word-he" data-link="sun">הַשָּׁמֶשׁ</span>
          </div>
          <div class="verse-en">What <span class="word-en" data-link="gain">gain</span> has <span class="word-en" data-link="man">man</span> from <span class="word-en" data-link="labor">all his toil</span> at which he <span class="word-en" data-link="toils">toils</span> <span class="word-en" data-link="under">under</span> the <span class="word-en" data-link="sun">sun</span>?</div>
        </div>
      </div>

      <div class="swiper-slide">
        <div class="verse">
          <div class="verse-he">
            <span class="word-he" data-link="generation">דּוֹר</span>
            <span class="word-he" data-link="goes">הֹלֵךְ</span>
            <span class="word-he" data-link="generation">וְדוֹר</span>
            <span class="word-he" data-link="comes">בָּא</span>
            <span class="word-he" data-link="earth">וְהָאָרֶץ</span>
            <span class="word-he" data-link="forever">לְעוֹלָם</span>
            <span class="word-he" data-link="remains">עֹמָדֶת</span>
          </div>
          <div class="verse-en">A <span class="word-en" data-link="generation">generation</span> <span class="word-en" data-link="goes">goes</span>, and a <span class="word-en" data-link="generation">generation</span> <span class="word-en" data-link="comes">comes</span>, but the <span class="word-en" data-link="earth">earth</span> <span class="word-en" data-link="remains">remains</span> <span class="word-en" data-link="forever">forever</span>.</div>
        </div>
      </div>
    </div>
    <div class="swiper-pagination"></div>
  </div>

  <!-- Hints -->
  <div class="hint scroll-hint" id="scrollHint">
    Swipe to explore
    <div class="chevron"></div>
  </div>
  <div class="hint tap-hint" id="tapHint">Tap the word to explore</div>

  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  <script src="https://unpkg.com/@popperjs/core@2"></script>
  <script src="https://unpkg.com/tippy.js@6"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>

  <script>
    const wordData = {
      'words': { hebrew: 'דִּבְרֵי', translit: 'div·rei', tidbit: 'The construct form of "devarim" (words/things). In Hebrew, words and things share the same root — speech has substance, creating reality.' },
      'teacher': { hebrew: 'קֹהֶלֶת', translit: 'qo·he·let', tidbit: 'From "qahal" (assembly). One who gathers people to teach. Traditionally identified as Solomon in his old age, reflecting on life\'s meaning.' },
      'son': { hebrew: 'בֶּן־דָּוִד', translit: 'ben-da·vid', tidbit: 'Son of David — a title claiming royal Davidic lineage. The hyphen (maqef) binds the words as one concept: a unified identity.' },
      'king': { hebrew: 'מֶלֶךְ', translit: 'me·lekh', tidbit: 'King — from a root meaning "to counsel." The king wasn\'t merely a ruler but an advisor to the nation, responsible for wisdom and justice.' },
      'jerusalem': { hebrew: 'בִּירוּשָׁלָֽםִ', translit: 'bi·ru·sha·la·yim', tidbit: 'In Jerusalem — literally "foundation of peace" (or "teaching of peace"). The city where heaven and earth meet, seat of wisdom and worship.' },
      'vanity': { hebrew: 'הֶבֶל', translit: 'he·vel', tidbit: 'Often translated "vanity" but literally means breath, vapor, or mist. Something that appears and quickly vanishes — not worthless, but fleeting and ungraspable.' },
      'says': { hebrew: 'אָמַר', translit: 'a·mar', tidbit: 'He said — the basic Hebrew word for speech. Its placement here gives Qohelet\'s words prophetic weight, like "thus says the LORD."' },
      'all': { hebrew: 'הַכֹּל', translit: 'ha·kol', tidbit: 'The all, everything — with the definite article. Not just "everything" but THE everything: the totality of human experience under the sun.' },
      'gain': { hebrew: 'מַה־יִּתְרוֹן', translit: 'mah-yit·ron', tidbit: 'What profit/advantage? "Yitron" appears only in Ecclesiastes — a commercial term asking what remains after all costs are counted.' },
      'man': { hebrew: 'לָאָדָם', translit: 'la·a·dam', tidbit: 'To/for the human — "adam" connects to "adamah" (earth/ground). Humanity is earthbound, made from dust and returning to it.' },
      'labor': { hebrew: 'בְּכָל־עֲמָלוֹ', translit: 'be·khol-a·ma·lo', tidbit: 'In all his toil — "amal" implies wearisome, exhausting labor. Not just work, but the grinding effort that wears down body and soul.' },
      'toils': { hebrew: 'שֶׁיַּעֲמֹל', translit: 'she·ya·a·mol', tidbit: 'That he toils — the same root as "amal" intensified. The repetition emphasizes life\'s endless cycle of effort upon effort.' },
      'under': { hebrew: 'תַּחַת', translit: 'ta·chat', tidbit: 'Under/beneath — establishes a boundary. Everything "under the sun" is earthly, temporal. What lies above remains a mystery.' },
      'sun': { hebrew: 'הַשָּׁמֶשׁ', translit: 'ha·sha·mesh', tidbit: 'The sun — "under the sun" appears 29 times in Ecclesiastes. It defines the book\'s scope: life as experienced in this visible world, under heaven\'s watchful eye.' },
      'generation': { hebrew: 'דּוֹר', translit: 'dor', tidbit: 'Generation — from a root meaning "to circle" or "to dwell." Each generation inhabits its moment, then yields to the next in an endless cycle.' },
      'goes': { hebrew: 'הֹלֵךְ', translit: 'ho·lekh', tidbit: 'Goes/walks away — the present participle of "halakh" (to walk). Life is movement toward departure; every generation is always already leaving.' },
      'comes': { hebrew: 'בָּא', translit: 'ba', tidbit: 'Comes/arrives — the counterpart to "goes." While one generation departs, another enters. The stage is never empty, yet the actors always change.' },
      'earth': { hebrew: 'וְהָאָרֶץ', translit: 've·ha·a·retz', tidbit: 'But the earth — "eretz" is the land, the ground, the world itself. Against human transience, it stands as silent witness to all comings and goings.' },
      'forever': { hebrew: 'לְעוֹלָם', translit: 'le·o·lam', tidbit: 'Forever — "olam" means hidden time, eternity, or age. The earth endures into time beyond human reckoning, a permanence we can name but never know.' },
      'remains': { hebrew: 'עֹמָדֶת', translit: 'o·me·det', tidbit: 'Stands/remains — from "amad" (to stand firm). While generations flow like water, the earth stands like a rock. The verb suggests quiet, steadfast presence.' }
    };

    const qohelet = document.getElementById('qohelet');
    const ph1 = document.getElementById('ph1');
    const ph2 = document.getElementById('ph2');
    const scrollHint = document.getElementById('scrollHint');
    const tapHint = document.getElementById('tapHint');

    // ===== QOHELET CHOREOGRAPHY =====
    // Measure placeholder positions dynamically (they're always in DOM, just translated)
    function getSlotPosition(placeholder) {
      const r = placeholder.getBoundingClientRect();
      const scale = parseFloat(getComputedStyle(placeholder).fontSize) /
                    parseFloat(getComputedStyle(qohelet).fontSize);
      return { x: r.left + r.width / 2, y: r.top + r.height / 2, scale };
    }

    function animateQohelet(index) {
      const cx = window.innerWidth / 2;
      const cy = window.innerHeight / 2;

      let state;
      switch (index) {
        case 0: state = { x: cx, y: cy + 70, scale: 1, opacity: 0 }; break;
        case 1: state = { x: cx, y: cy + 40, scale: 1, opacity: 1 }; break;
        case 2: state = { x: cx, y: cy, scale: 1, opacity: 1 }; break;
        case 3:
          const s1 = getSlotPosition(ph1);
          state = { x: s1.x, y: s1.y, scale: s1.scale, opacity: 1 };
          break;
        case 4:
          const s2 = getSlotPosition(ph2);
          state = { x: s2.x, y: s2.y, scale: s2.scale, opacity: 1 };
          break;
        default: // 5+: fade out at last position
          const s2b = getSlotPosition(ph2);
          state = { x: s2b.x, y: s2b.y, scale: s2b.scale, opacity: 0 };
          break;
      }

      qohelet.classList.toggle('visible', state.opacity > 0);

      gsap.to(qohelet, {
        left: state.x,
        top: state.y,
        scale: state.scale,
        opacity: state.opacity,
        duration: 0.6,
        ease: 'power2.inOut'
      });
    }

    // ===== VERSE ANIMATIONS =====
    function animateVerseIn(slide) {
      const words = slide.querySelectorAll('.word-he');
      const en = slide.querySelector('.verse-en');
      if (!words.length) return;

      gsap.fromTo(words,
        { opacity: 0, y: 10 },
        { opacity: 1, y: 0, stagger: 0.06, duration: 0.4, ease: 'back.out(1.4)' }
      );
      gsap.to(en, { opacity: 1, duration: 0.5, delay: 0.3 });
    }

    function resetVerse(slide) {
      const words = slide.querySelectorAll('.word-he');
      const en = slide.querySelector('.verse-en');
      if (!words.length) return;

      gsap.set(words, { opacity: 0, y: 10 });
      gsap.set(en, { opacity: 0 });
    }

    // ===== HIGHLIGHTING =====
    let litElements = [];
    function lightUp(link) {
      litElements.forEach(el => el.classList.remove('lit'));
      litElements = [...document.querySelectorAll(`[data-link="${link}"]`)];
      litElements.forEach(el => el.classList.add('lit'));
    }
    function clearLit() {
      litElements.forEach(el => el.classList.remove('lit'));
      litElements = [];
    }

    // ===== HINTS =====
    let scrollHintShown = false, tapHintDismissed = false;

    function updateHints(index) {
      if (index === 0 && !scrollHintShown) {
        setTimeout(() => scrollHint.classList.add('visible'), 2000);
        scrollHintShown = true;
      } else {
        scrollHint.classList.remove('visible');
      }

      if (index === 2 && !tapHintDismissed) {
        tapHint.classList.add('visible');
      } else {
        tapHint.classList.remove('visible');
      }
    }

    // ===== INIT =====
    document.fonts.ready.then(() => {
      // Force layout before measuring
      document.body.offsetHeight;

      const swiper = new Swiper('.swiper', {
        direction: 'vertical',
        speed: 600,
        keyboard: { enabled: true },
        mousewheel: { sensitivity: 1 },
        pagination: { el: '.swiper-pagination', type: 'progressbar' },
        on: {
          slideChange: function () {
            animateQohelet(this.activeIndex);
            updateHints(this.activeIndex);

            const slide = this.slides[this.activeIndex];
            if (slide.querySelector('.verse')) {
              animateVerseIn(slide);
            }
          },
          slideChangeTransitionEnd: function () {
            this.slides.forEach((slide, i) => {
              if (i !== this.activeIndex) resetVerse(slide);
            });
          }
        }
      });

      tippy('[data-link]', {
        content: el => {
          const d = wordData[el.dataset.link];
          return d ? `<div class="tooltip-hebrew">${d.hebrew}</div>
                      <div class="tooltip-translit">${d.translit}</div>
                      <div class="tooltip-tidbit">${d.tidbit}</div>` : '';
        },
        allowHTML: true,
        theme: 'ecclesiastes',
        placement: 'top',
        animation: 'scale',
        interactive: true,
        appendTo: document.body,
        onShow: inst => {
          lightUp(inst.reference.dataset.link);
          tapHintDismissed = true;
          tapHint.classList.remove('visible');
        },
        onHide: clearLit
      });

      animateQohelet(0);
      updateHints(0);

      window.addEventListener('resize', () => animateQohelet(swiper.activeIndex));
    });
  </script>
</body>
</html>
